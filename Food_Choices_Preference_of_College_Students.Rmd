---
title: "Food Choices and Preference of College Students"
author: "Charlene"
date: "2023-08-09"
output: rmarkdown::github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loading readr package

Dataset used for this project was imported using readr package. To do so, the tidyverse package which contains readr package was installed and loaded.

## Importing CSV file

```{r import data, echo=FALSE, message=FALSE}
food_survey_respond_df <-readr::read_csv("~/Desktop/My Projects/Food Choices and Preference of College Students/food_coded.csv")

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## Data cleaning

#### Preview dataset

Packages required in this step: Here, Skimr, Janitor, dply.

```{r head()}
head(food_survey_respond_df)
```

```{r glimpse()}
library(dplyr)
glimpse(food_survey_respond_df)
```

```{r colnames()}
colnames(food_survey_respond_df)

```

#### Remove missing values

Removed rows with missing values (NA) and saved it as a new dataframe (new_responds_df).

```{r drop na}
library(tidyr)
food_survey_respond_df %>% 
  drop_na() -> new_respond_df
nrow(new_respond_df) # left 60 responses after dropping na
```

## Data Transformation

In this part of the analysis, 3 new dataframes will be created with variables of interest that were required to answer the following questions:

-   Question 1: Does exercising regularly affects weight of an individual?

-   Question 2: Does factors such as: Employment, Income, and Living on or off campus affect the frequency of eating out for college students?

-   Question 3: Does students who exercise regularly more likely to make better food choices?

#### Question 1: Creating new dataframe with variables of interest

In the preview of the food_survey_respond_df, there are 61 variables in this dataset. Not all the variables will be needed in our analysis, therefore, only the variables of interest will be selected and stored in a new dataframe for easy access later.

```{r}
weight_df<- new_respond_df %>% 
  select("Gender","exercise","weight")

weight_df %>% 
  count(weight) # to identify which responds needs cleaning / removing

weight_df %>% 
  count(Gender) # should have 1 & 2 only. 1= Female, 2 = Male

weight_df %>% 
  count(exercise)
```

There are 4 rows in weight that needs cleaning before we can start analysis.

```{r}
library(stringr)
weight_df$weight <- str_replace_all(weight_df$weight, "^144 lbs$", "144")
weight_df$weight <- str_replace_all(weight_df$weight, "^Not sure, 240$", "240")

#Removing Row 2 & row 45
weight_df<- weight_df[-c(2,45),]

#Double checking the data within weight to make sure we have cleaned up properly
weight_df %>% 
  count(weight)
```

#### Question 1: Replace Integer respond for Gender with String

```{r}
weight_df <- weight_df %>% 
  mutate(Gender_Num = Gender) # create a duplicate column to preserve original data
weight_df$Gender <- str_replace_all(weight_df$Gender, "^1$", "Female")
weight_df$Gender <- str_replace_all(weight_df$Gender, "^2$", "Male")

weight_df %>% 
  count(Gender)
```

#### Question 1: Replace Integer respond for exercise with String

```{r}
weight_df <- weight_df %>% 
  mutate(exercise_Num = exercise) # create a duplicate column to preserve original data
weight_df$exercise <- str_replace_all(weight_df$exercise, "1", "Everyday")
weight_df$exercise <- str_replace_all(weight_df$exercise, "3", "once a week")
weight_df$exercise <- str_replace_all(weight_df$exercise, "2", "2-3 times a week")
weight_df$exercise <- str_replace_all(weight_df$exercise, "4", "Sometimes")
weight_df$exercise <- str_replace_all(weight_df$exercise, "5", "Never")

weight_df %>% 
  count(exercise)
```

#### Question 1: Replace Integer respond for weight with String

```{r}
weight_df %>% 
  group_by (weight) %>% 
  summarize(count = sum(weight <129))
```

```{r}
weight_df %>% 
  group_by (weight) %>% 
  summarize(count= sum(weight >129 & weight <159))
```

```{r}
weight_df %>% 
  group_by (weight) %>% 
  summarize(count= sum(weight >159 & weight <189))
```

```{r}
weight_df %>% 
  group_by (weight) %>% 
  summarize(count= sum(weight >=190))
```

```{r}
#creating new column in weight_df
weight_df<- weight_df %>% 
  mutate(weight_df, weight_range=weight)

#Rename 110 - 129 lbs:
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^110$", "110-129")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^115$", "110-129")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^116$", "110-129")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^120$", "110-129")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^123$", "110-129")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^125$", "110-129")

#Rename 130 - 159 lbs:
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^130$", "130-159")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^135$", "130-159")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^137$", "130-159")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^140$", "130-159")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^144$", "130-159")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^145$", "130-159")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^150$", "130-159")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^155$", "130-159")

#Rename 160 -189 lbs:
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^160$", "160-189")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^165$", "160-189")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^167$", "160-189")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^168$", "160-189")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^169$", "160-189")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^170$", "160-189")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^175$", "160-189")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^180$", "160-189")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^185$", "160-189")

#Rename >190 lbs:
weight_df$weight_range <-
str_replace_all(weight_df$weight_range, "^190$", ">189")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^200$", ">189")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^205$", ">189")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^210$", ">189")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^240$", ">189")
weight_df$weight_range <- str_replace_all(weight_df$weight_range, "^264$", ">189")
```

#### Question 2: Creating new dataframe with variables of interest

```{r new dataframe for frequency of eating out & regular exercise leads to making better food choice}
frequency_df <- new_respond_df %>% 
  select ("eating_out","employment","income","on_off_campus")

glimpse(frequency_df)
```

#### Question 2: Replace Integer respond for eating_out with String

```{r}
frequency_df <- frequency_df %>% 
  mutate(eating_out_Num = eating_out) # create a duplicate column to preserve original data
frequency_df$eating_out <- str_replace_all(frequency_df$eating_out, "^1$", "Never")
frequency_df$eating_out <- str_replace_all(frequency_df$eating_out, "^2$", "1-2 times")
frequency_df$eating_out <- str_replace_all(frequency_df$eating_out, "^3$", "2-3 times")
frequency_df$eating_out <- str_replace_all(frequency_df$eating_out, "^5$", "Everyday")
frequency_df$eating_out <- str_replace_all(frequency_df$eating_out, "^4$", "3-5 times")


frequency_df %>% 
  count(eating_out) # checking if above code has been run correctly
```

#### Question 2: Replace Integer respond for employment with String

```{r}
frequency_df <- frequency_df %>% 
  mutate(employment_Num = employment) # create a duplicate to preserve original data column
frequency_df$employment <- str_replace_all(frequency_df$employment, "1", "Full time")
frequency_df$employment <- str_replace_all(frequency_df$employment, "2", "Part time")
frequency_df$employment <- str_replace_all(frequency_df$employment, "3", "Unemployed")

frequency_df %>% 
  count(employment)
```

#### Question 2: Replace Integer respond for income with String

```{r}
frequency_df <- frequency_df %>% 
  mutate(income_Num = income) # create a duplicate column to preserve original data
frequency_df$income <- str_replace_all(frequency_df$income, "^1$", "less than $15K")
frequency_df$income <- str_replace_all(frequency_df$income, "^2$", "$15.001K-$30K")
frequency_df$income <- str_replace_all(frequency_df$income, "^3$", "$30.001K-$50K")
frequency_df$income <- str_replace_all(frequency_df$income, "^4$", "$50.001K-$70K")
frequency_df$income <- str_replace_all(frequency_df$income, "^5$", "$70.001K-$100K")
frequency_df$income <- str_replace_all(frequency_df$income, "^6$", "more than $100K")

frequency_df %>% 
  count(income)
```

#### Question 2: Replace Integer respond for living on and off campus with String

```{r}
frequency_df <- frequency_df %>% 
  mutate(income_Num = on_off_campus) # create a duplicate column to preserve original data
frequency_df$on_off_campus <- str_replace_all(frequency_df$on_off_campus, "1", "On campus")
frequency_df$on_off_campus <- str_replace_all(frequency_df$on_off_campus, "2", "Off campus")
frequency_df$on_off_campus <- str_replace_all(frequency_df$on_off_campus, "3", "Off campus")
frequency_df$on_off_campus <- str_replace_all(frequency_df$on_off_campus, "4", "Off campus")

frequency_df %>% 
  count(on_off_campus)
```

#### Question 3: Creating new dataframe with variables of interest

```{r}
exercise_df <- new_respond_df %>% 
  select ("exercise","nutritional_check","veggies_day","fruit_day")

glimpse(exercise_df)
```

#### Question 3: Replace Integer respond for exercise with String

```{r}
exercise_df <- exercise_df %>% 
  mutate(exercise_Num = exercise) # create a duplicate column to preserve original data
exercise_df$exercise <- str_replace_all(exercise_df$exercise, "1", "Everyday")
exercise_df$exercise <- str_replace_all(exercise_df$exercise, "3", "once a week")
exercise_df$exercise <- str_replace_all(exercise_df$exercise, "2", "2-3 times a week")
exercise_df$exercise <- str_replace_all(exercise_df$exercise, "4", "Sometimes")
exercise_df$exercise <- str_replace_all(exercise_df$exercise, "5", "Never")

exercise_df %>% 
  count(exercise)
```

#### Question 3: Replace Integer respond for Nutritional check with String

```{r}
exercise_df <- exercise_df %>% 
  mutate(nutritional_check_Num = nutritional_check) # create a duplicate column to preserve original data
exercise_df$nutritional_check <- str_replace_all(exercise_df$nutritional_check, "1", "Never")
exercise_df$nutritional_check <- str_replace_all(exercise_df$nutritional_check, "2", "On certain products")
exercise_df$nutritional_check <- str_replace_all(exercise_df$nutritional_check, "3", "Very rarely")
exercise_df$nutritional_check <- str_replace_all(exercise_df$nutritional_check, "4", "On most products")
exercise_df$nutritional_check <- str_replace_all(exercise_df$nutritional_check, "5", "On everything")

exercise_df %>% 
  count(nutritional_check)
```

#### Question 3: Replace Integer respond for veggie consumption with String

```{r}
exercise_df <- rename(exercise_df,"veggie_consumption" = "veggies_day") #rename column name for better representation of data

exercise_df <- exercise_df %>% 
  mutate(veggie_consumption_Num = veggie_consumption) # create a duplicate column to preserve original data

exercise_df$veggie_consumption <- str_replace_all(exercise_df$veggie_consumption, "1", "Very unlikely")
exercise_df$veggie_consumption <- str_replace_all(exercise_df$veggie_consumption, "2", "Unlikely")
exercise_df$veggie_consumption <- str_replace_all(exercise_df$veggie_consumption, "3", "Neutral")
exercise_df$veggie_consumption <- str_replace_all(exercise_df$veggie_consumption, "4", "Likely")
exercise_df$veggie_consumption <- str_replace_all(exercise_df$veggie_consumption, "5", "Very likely")

exercise_df %>% 
  count(veggie_consumption)
```

#### Question 3: Replace Integer respond for fruit consumption with String

```{r}
exercise_df <- rename(exercise_df,"fruit_consumption"= "fruit_day") #rename column name for better representation of data

exercise_df<- exercise_df %>% 
  mutate(fruit_consumption_Num = fruit_consumption)

exercise_df$fruit_consumption <- str_replace_all(exercise_df$fruit_consumption, "1", "Very unlikely")
exercise_df$fruit_consumption <- str_replace_all(exercise_df$fruit_consumption, "2", "Unlikely")
exercise_df$fruit_consumption <- str_replace_all(exercise_df$fruit_consumption, "3", "Neutral")
exercise_df$fruit_consumption <- str_replace_all(exercise_df$fruit_consumption, "4", "Likely")
exercise_df$fruit_consumption <- str_replace_all(exercise_df$fruit_consumption, "5", "Very likely")

exercise_df %>% 
  count(fruit_consumption)
```

## Data Vizualization

#### Question 1: Eating out VS Employment status

```{r}
#filter Female:
library(ggplot2)
weight_female <- weight_df %>% 
  filter(Gender == "Female")
ggplot(data=weight_female)+
  geom_bar(mapping= aes(x=exercise, fill=weight_range))+ labs(title="Exercise VS Weight (lbs)", x= "Exercise", y= "Frequency", subtitle= "Female")
```

Among female students, individuals in the lowest weight range 110 - 129 lbs mostly exercise daily while a small group exercises at least 2 - 3 times a week. Individuals in the 2nd lowest weight range mostly exercise daily or 2 to 3 times a week, while a small group exercises once a week. Individuals in 160 - 189 lbs range either exercise daily or just once a week and for individuals in \>189 lbs range, most of them exercise daily.

```{r}
#filter Male:
weight_male <- weight_df %>% 
  filter(Gender == "Male")
ggplot(data=weight_male)+
  geom_bar(mapping= aes(x=exercise, fill=weight_range))+ labs(title="Exercise VS Weight (lbs)", x= "Exercise", y= "Frequency", subtitle= "Male")
```

Among male students, individuals in the lowest weight range 130 - 159 lbs exercises daily. Most individuals in the 160 - 189 lbs range exercises daily and \>189 lbs 2 - 3 times a week.

#### Question 2: Eating out VS Employment status

```{r}
ggplot(data=frequency_df)+
  geom_bar(mapping=aes (x=eating_out, fill=employment)) + labs(title = "Frequency of Eating Out VS Employment", x ="Eating out", y="Frequency") + theme(axis.text.x = element_text(angle = 45))
```

Most college students regardless of their employment status tends to eat out 1 - 2 times a week, and only very few eat out everyday.

#### Question 2: Eating out VS Income

```{r}
ggplot(data=frequency_df)+
  geom_bar(mapping=aes (x=eating_out, fill=income)) + labs(title = "Frequency of Eating Out VS Income", x ="Eating out", y="Frequency") + theme(axis.text.x = element_text(angle = 45))
```

There is a similar trend observed here compared to Frequency of eating out VS employment where most student regardless of income eats out 1 - 2 time a week, followed by 2 to 3 times, never, 3 to 5 times and least number of students eat out everyday.

An additional observation made is, only students with income of more than \$100K chooses to eat out everyday.

#### Question 2: Eating out VS Living on or off campus

```{r}
ggplot(data=frequency_df)+
  geom_bar(mapping=aes (x=eating_out, fill=on_off_campus)) + labs(title = "Frequency of Eating Out VS Living on or off Campus", x ="Eating out", y="Frequency") + theme(axis.text.x = element_text(angle = 45))
```

There is a similar trend observed for the frequency of eating out VS Living on or off campus as the other two factors (employment & income), where most college students regardless of living situation tends to eat out mostly 1-2 times a week and very small number of students eat out everyday. Those who does eat out everyday tend to be living on campus.

#### Question 3: Exercise VS Nutritional check

```{r}
ggplot(data=exercise_df)+
  geom_bar(mapping=aes(fill=exercise,x=nutritional_check)) +
  labs(title="Exercise VS Nutritional checks", x= "Nutritional checks", y="Frequency") + theme(axis.text.x = element_text(angle = 45))
```

Generally students who exercises more often tends to check nutritional content of the food they consume. This would also make them more conscious of the food choices they make and thus have higher chances of making better food choices compared to students who do not.

#### Question 3: Exercise VS Veggie consumption

```{r}
ggplot(data=exercise_df)+
  geom_bar(mapping=aes(fill=exercise,x=veggie_consumption)) +
  labs(title="Exercise VS Veggie consumption", x= "Veggie consumption", y="Frequency") + theme(axis.text.x = element_text(angle = 45))
```

The general observation of vegetables consumption in relation to frequency of exercising is that students who exercise more regularly are more likely to consume vegetables. However, it is also seen that a small group of students who exercise daily or 2-3 times a week are unlikely to consume vegetables. This group of students might have food aversion to vegetables.

#### Question 3: Exercise VS Fruit consumption

```{r}
ggplot(data=exercise_df)+
  geom_bar(mapping=aes(fill=exercise,x=fruit_consumption)) +
  labs(title="Exercise VS Fruit consumption", x= "Fruit consumption", y="Frequency") + theme(axis.text.x = element_text(angle = 45))
```

Similar to the observation made for vegetable consumption, students who exercise more regularly are likely to consume fruits and there is also a small group of students who exercise daily but is unlikely to consume fruit. We should also keep in mind that this group of students might have food aversion towards fruits.
